"use strict";

var _amen = require("@dashkite/amen");

var _amenConsole = _interopRequireDefault(require("@dashkite/amen-console"));

var _assert = _interopRequireDefault(require("@dashkite/assert"));

var _configuration = _interopRequireDefault(require("./configuration.js"));

var _base = require("../src/base.js");

var _index = require("../src/index.js");

var _html = _interopRequireDefault(require("./helpers/html.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var test;

test = function (name, f) {
  return (0, _amen.test)({
    description: name,
    wait: 30000
  }, f);
};

(async function ({
  base,
  record
}) {
  (0, _amenConsole.default)(await (0, _amen.test)("Airtable Helpers", [await (0, _amen.test)("Base", [await test("create", async function () {
    base = await _base.Base.create(_configuration.default.airtable);
    return await base.create({
      table: "Test",
      records: [{
        "Name": "Test",
        "Notes": "This is a test."
      }]
    });
  }), await (0, _amen.test)("find", [test("single", async function () {
    record = await base.find({
      table: "Pagination Test",
      id: "recqH6NNMug5nFtC2"
    });
    return (0, _assert.default)(record != null);
  }), test("multiple", async function () {
    record = await base.findAll({
      table: "Pagination Test",
      ids: ["recqH6NNMug5nFtC2", "rec1HIU8rDLhLgW9g"]
    });
    console.log({
      record
    });
    return _assert.default.equal(2, record.length);
  }), test("single not found", async function () {
    record = await base.find({
      table: "Pagination Test",
      id: "foobar"
    });
    return (0, _assert.default)(record == null);
  }), test("multiple not found", async function () {
    record = await base.findAll({
      table: "Pagination Test",
      ids: ["foo", "bar"]
    });
    return _assert.default.equal(0, record.length);
  })]), await test("selectOne", async function () {
    record = await base.selectOne({
      table: "Test",
      query: "{Name} = 'Test'"
    });
    return _assert.default.equal("Test", record.get("Name"));
  }), await test("selectAll", async function () {
    var records;
    records = await base.selectAll({
      table: "Pagination Test"
    });
    return _assert.default.equal(110, records.length);
  }), await test("update", async function () {
    var notes;
    notes = record.get("Notes");

    if (notes === "This is a test.") {
      notes = "This is not a test.";
    } else {
      notes = "This is a test.";
    }

    record = await base.update({
      table: "Test",
      id: record.id,
      fields: {
        Notes: notes
      }
    });
    return _assert.default.equal(notes, record.get("Notes"));
  }), await test("replace", async function () {
    var notes;
    notes = record.get("Notes");

    if (notes === "This is a test.") {
      notes = "This is not a test.";
    } else {
      notes = "This is a test.";
    }

    record = await base.replace({
      table: "Test",
      id: record.id,
      fields: {
        Notes: notes
      }
    });
    return _assert.default.equal(notes, record.get("Notes"));
  }), await test("delete", async function () {
    return await base.delete({
      table: "Test",
      id: record.id
    });
  })])]));
  return process.exit(_amen.success);
})({});
//# sourceMappingURL=data:application/json;base64,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QSxNQUFBLEVBQUEsRUFBSSxNQUFNLENBRFYsRUFBQTtBQUVBLE1BQUEsTUFBQSxFQUNFO0FBQUEsUUFBQSxLQUFBLEVBQU87QUFBUDtBQUhGLEtBRGEsQ0FBZjtXQU1BLGdCQUFBLEtBQUEsQ0FBQSxLQUFBLEVBQW9CLE1BQU0sQ0FBTixHQUFBLENBQXBCLE9BQW9CLENBQXBCLEM7QUFuRmdCLEdBb0VaLENBcEVZLEVBcUZsQixNQUFNLElBQUEsQ0FBQSxRQUFBLEVBQWUsa0JBQUE7QUFDbkIsV0FBQSxNQUFNLElBQUksQ0FBSixNQUFBLENBQ0o7QUFBQSxNQUFBLEtBQUEsRUFBQSxNQUFBO0FBQ0EsTUFBQSxFQUFBLEVBQUksTUFBTSxDQUFDO0FBRFgsS0FESSxDQUFOO0FBdEZnQixHQXFGWixDQXJGWSxDQUFkLENBRjhCLENBQTFCLENBQVo7U0FrR0EsT0FBTyxDQUFQLElBQUEsQ0FBQSxhQUFBLEM7QUFwR0MsQ0FBQSxFQUFvQixFQUFwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRlc3QgYXMgX3Rlc3QsIHN1Y2Nlc3MgfSBmcm9tIFwiQGRhc2hraXRlL2FtZW5cIlxuaW1wb3J0IHByaW50IGZyb20gXCJAZGFzaGtpdGUvYW1lbi1jb25zb2xlXCJcbmltcG9ydCBhc3NlcnQgZnJvbSBcIkBkYXNoa2l0ZS9hc3NlcnRcIlxuXG5pbXBvcnQgY29uZmlndXJhdGlvbiBmcm9tIFwiLi9jb25maWd1cmF0aW9uXCJcblxuaW1wb3J0IHsgQmFzZSB9IGZyb20gXCIuLi9zcmMvYmFzZVwiXG5pbXBvcnQgeyBTaXRlLCBQYWdlLCBDb250ZW50IH0gZnJvbSBcIi4uL3NyY1wiXG5cbmltcG9ydCBodG1sIGZyb20gXCIuL2hlbHBlcnMvaHRtbFwiXG5cbnRlc3QgPSAobmFtZSwgZikgLT5cbiAgX3Rlc3RcbiAgICBkZXNjcmlwdGlvbjogbmFtZVxuICAgIHdhaXQ6IDMwMDAwXG4gICAgZlxuXG5kbyAoeyBiYXNlLCByZWNvcmQgfSA9IHt9KSAtPlxuXG4gIHByaW50IGF3YWl0IF90ZXN0IFwiQWlydGFibGUgSGVscGVyc1wiLCBbXG5cbiAgICBhd2FpdCBfdGVzdCBcIkJhc2VcIiwgW1xuXG4gICAgICBhd2FpdCB0ZXN0IFwiY3JlYXRlXCIsIC0+XG4gICAgICAgIGJhc2UgPSBhd2FpdCBCYXNlLmNyZWF0ZSBjb25maWd1cmF0aW9uLmFpcnRhYmxlXG4gICAgICAgIGF3YWl0IGJhc2UuY3JlYXRlXG4gICAgICAgICAgdGFibGU6IFwiVGVzdFwiXG4gICAgICAgICAgcmVjb3JkczogW1xuICAgICAgICAgICAgXCJOYW1lXCI6IFwiVGVzdFwiXG4gICAgICAgICAgICBcIk5vdGVzXCI6IFwiVGhpcyBpcyBhIHRlc3QuXCJcbiAgICAgICAgICBdXG5cbiAgICAgIGF3YWl0IF90ZXN0IFwiZmluZFwiLCBbXG4gICAgICAgIFxuICAgICAgICB0ZXN0IFwic2luZ2xlXCIsIC0+XG4gICAgICAgICAgcmVjb3JkID0gYXdhaXQgYmFzZS5maW5kIFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkOiBcInJlY3FINk5OTXVnNW5GdEMyXCJcbiAgICAgICAgICBhc3NlcnQgcmVjb3JkP1xuXG4gICAgICAgIHRlc3QgXCJtdWx0aXBsZVwiLCAtPlxuICAgICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UuZmluZEFsbFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkczogWyBcInJlY3FINk5OTXVnNW5GdEMyXCIsIFwicmVjMUhJVThyRExoTGdXOWdcIiBdXG4gICAgICAgICAgY29uc29sZS5sb2cgeyByZWNvcmQgfVxuICAgICAgICAgIGFzc2VydC5lcXVhbCAyLCByZWNvcmQubGVuZ3RoXG4gICAgICAgICAgXG4gICAgICAgIHRlc3QgXCJzaW5nbGUgbm90IGZvdW5kXCIsIC0+XG4gICAgICAgICAgcmVjb3JkID0gYXdhaXQgYmFzZS5maW5kIFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkOiBcImZvb2JhclwiXG4gICAgICAgICAgYXNzZXJ0ICFyZWNvcmQ/XG5cbiAgICAgICAgdGVzdCBcIm11bHRpcGxlIG5vdCBmb3VuZFwiLCAtPlxuICAgICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UuZmluZEFsbFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkczogWyBcImZvb1wiLCBcImJhclwiIF1cbiAgICAgICAgICBhc3NlcnQuZXF1YWwgMCwgcmVjb3JkLmxlbmd0aFxuICAgICAgXG4gICAgICBdXG5cbiAgICAgIGF3YWl0IHRlc3QgXCJzZWxlY3RPbmVcIiwgLT5cbiAgICAgICAgcmVjb3JkID0gYXdhaXQgYmFzZS5zZWxlY3RPbmVcbiAgICAgICAgICB0YWJsZTogXCJUZXN0XCJcbiAgICAgICAgICBxdWVyeTogXCJ7TmFtZX0gPSAnVGVzdCdcIlxuICAgICAgICBhc3NlcnQuZXF1YWwgXCJUZXN0XCIsIHJlY29yZC5nZXQgXCJOYW1lXCJcblxuICAgICAgYXdhaXQgdGVzdCBcInNlbGVjdEFsbFwiLCAtPlxuICAgICAgICByZWNvcmRzID0gYXdhaXQgYmFzZS5zZWxlY3RBbGxcbiAgICAgICAgICB0YWJsZTogXCJQYWdpbmF0aW9uIFRlc3RcIlxuICAgICAgICBhc3NlcnQuZXF1YWwgMTEwLCByZWNvcmRzLmxlbmd0aFxuXG4gICAgICBhd2FpdCB0ZXN0IFwidXBkYXRlXCIsIC0+XG5cbiAgICAgICAgbm90ZXMgPSByZWNvcmQuZ2V0IFwiTm90ZXNcIlxuXG4gICAgICAgIGlmIG5vdGVzID09IFwiVGhpcyBpcyBhIHRlc3QuXCJcbiAgICAgICAgICBub3RlcyA9IFwiVGhpcyBpcyBub3QgYSB0ZXN0LlwiXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBub3RlcyA9IFwiVGhpcyBpcyBhIHRlc3QuXCJcblxuICAgICAgICByZWNvcmQgPSBhd2FpdCBiYXNlLnVwZGF0ZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcbiAgICAgICAgICBmaWVsZHM6XG4gICAgICAgICAgICBOb3Rlczogbm90ZXNcbiAgICAgICAgXG4gICAgICAgIGFzc2VydC5lcXVhbCBub3RlcywgcmVjb3JkLmdldCBcIk5vdGVzXCJcblxuICAgICAgYXdhaXQgdGVzdCBcInJlcGxhY2VcIiwgLT5cblxuICAgICAgICBub3RlcyA9IHJlY29yZC5nZXQgXCJOb3Rlc1wiXG5cbiAgICAgICAgaWYgbm90ZXMgPT0gXCJUaGlzIGlzIGEgdGVzdC5cIlxuICAgICAgICAgIG5vdGVzID0gXCJUaGlzIGlzIG5vdCBhIHRlc3QuXCJcbiAgICAgICAgZWxzZVxuICAgICAgICAgIG5vdGVzID0gXCJUaGlzIGlzIGEgdGVzdC5cIlxuXG4gICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UucmVwbGFjZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcbiAgICAgICAgICBmaWVsZHM6XG4gICAgICAgICAgICBOb3Rlczogbm90ZXNcbiAgICAgICAgXG4gICAgICAgIGFzc2VydC5lcXVhbCBub3RlcywgcmVjb3JkLmdldCBcIk5vdGVzXCJcblxuICAgICAgYXdhaXQgdGVzdCBcImRlbGV0ZVwiLCAtPlxuICAgICAgICBhd2FpdCBiYXNlLmRlbGV0ZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcblxuICAgIF1cblxuXG4gIF1cblxuICBcbiAgcHJvY2Vzcy5leGl0IHN1Y2Nlc3NcblxuIl0sInNvdXJjZVJvb3QiOiIifQ==
//# sourceURL=test/index.coffee